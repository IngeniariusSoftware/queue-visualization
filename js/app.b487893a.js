(function(){"use strict";var t={1029:function(t,e,i){var s=i(5102),a=i(9269);const r={class:"q-pa-md row q-gutter-md"};function n(t,e,i,s,n,o){const h=(0,a.up)("QueueChart"),u=(0,a.up)("q-card-section"),l=(0,a.up)("q-card");return(0,a.wg)(),(0,a.iD)("div",r,[(0,a.Wm)(l,null,{default:(0,a.w5)((()=>[(0,a.Wm)(u,{style:{padding:"0"}},{default:(0,a.w5)((()=>[(0,a.Wm)(h,{id:"1",margin:n.margin,width:.48*n.width,height:.47*n.height,"arrival-interval":n.arrivalInterval,"take-interval":n.takeInterval,"passengers-count":n.passengersCount,"static-stations-count":n.staticStationsCount,"is-station-has-queue":!1},null,8,["margin","width","height","arrival-interval","take-interval","passengers-count","static-stations-count"])])),_:1})])),_:1}),(0,a.Wm)(l,null,{default:(0,a.w5)((()=>[(0,a.Wm)(u,{style:{padding:"0"}},{default:(0,a.w5)((()=>[(0,a.Wm)(h,{id:"2",margin:n.margin,width:.48*n.width,height:.47*n.height,"arrival-interval":n.arrivalInterval,"take-interval":n.takeInterval,"passengers-count":n.passengersCount,"static-stations-count":n.staticStationsCount,"is-station-has-queue":!0},null,8,["margin","width","height","arrival-interval","take-interval","passengers-count","static-stations-count"])])),_:1})])),_:1}),(0,a.Wm)(l,null,{default:(0,a.w5)((()=>[(0,a.Wm)(u,{style:{padding:"0"}},{default:(0,a.w5)((()=>[(0,a.Wm)(h,{id:"3",margin:n.margin,width:.48*n.width,height:.47*n.height,"arrival-interval":n.arrivalInterval,"take-interval":n.takeInterval,"passengers-count":n.passengersCount,"static-stations-count":n.staticStationsCount+1,"is-station-has-queue":!1},null,8,["margin","width","height","arrival-interval","take-interval","passengers-count","static-stations-count"])])),_:1})])),_:1}),(0,a.Wm)(l,null,{default:(0,a.w5)((()=>[(0,a.Wm)(u,{style:{padding:"0"}},{default:(0,a.w5)((()=>[(0,a.Wm)(h,{id:"4",margin:n.margin,width:.48*n.width,height:.47*n.height,"arrival-interval":n.arrivalInterval,"take-interval":n.takeInterval,"passengers-count":n.passengersCount,"static-stations-count":n.staticStationsCount+1,"is-station-has-queue":!0},null,8,["margin","width","height","arrival-interval","take-interval","passengers-count","static-stations-count"])])),_:1})])),_:1})])}const o=["id"];function h(t,e,i,s,r,n){return(0,a.wg)(),(0,a.iD)("div",{id:n.containerID.replace("#","")},null,8,o)}i(4719);var u=i(8735);const l="QueueChart",g=1,c=.1,p=1,d=1e3/g,v=["#f7cc05","#eb2d23","#1c3f91","#079bd7","#00883a","#f0859d","#ae5e3b"];var m={name:l,data(){return{rootGroup:Selection,stationsGroup:Selection,passengersGroup:Selection,statisticsGroup:Selection,stations:[],passengers:[],generalPassengersQueue:[],arrivalPassengerIndex:0,lastArrivalTime:0,getPositionInGeneralQueue:void 0,statisticsTimerId:0,time:0,serviceTimes:[],waitingTimes:[],statistics:[{label:"Work time",value:0},{label:"Waiting probability",value:0},{label:"Average waiting time",value:0},{label:"Average service time",value:0},{label:"Server idle probability",value:0},{label:"Average time between arrivals",value:0},{label:"Average waiting time who waited",value:0},{label:"Passengers count",value:0}]}},props:{id:{type:String,required:!0},margin:{type:Object,required:!0},width:{type:Number,required:!0},height:{type:Number,required:!0},staticStationsCount:{type:Number,required:!0},passengersCount:{type:Number,required:!0},arrivalInterval:{type:Number,required:!0},takeInterval:{type:Number,required:!0},isStationHasQueue:{type:Boolean,required:!0}},computed:{containerID(){return`#${l}Container${this.id}`},visibleAreaID(){return`#${l}VisibleDefs${this.id}`},innerWidth(){return this.width-this.margin.left-this.margin.right},innerHeight(){return this.height-this.margin.top-this.margin.bottom},passengerGraphicModelSize(){return this.innerHeight/(2*(this.staticStationsCount+1))}},mounted(){this.rootGroup=f(this.containerID,this.width,this.height,this.margin),this.stationsGroup=this.rootGroup.append("g"),this.passengersGroup=this.rootGroup.append("g"),this.statisticsGroup=this.rootGroup.append("g"),this.generatePassengers(this.passengersCount,this.passengers,this.arrivalInterval),this.generateStations(this.stationsGroup,this.stations,this.staticStationsCount),this.getPositionInGeneralQueue=this.isStationHasQueue?this.getPositionWithoutGeneralQueue:this.getPositionWithGeneralQueue,this.getFreeStation=this.isStationHasQueue?this.getFreeStationWithoutGeneralQueue:this.getFreeStationWithGeneralQueue,this.statistics[5].value=this.passengers.map(((t,e)=>t.arrivalTime-(e>0?this.passengers[e-1].arrivalTime:0))).reduce(((t,e)=>t+e),0),this.statistics[5].value/=this.passengers.length,this.time=c,setInterval((()=>this.time+=c*p),d*c),this.addStatistics(),this.statisticsTimerId=setInterval(this.addStatistics,d),this.arrivePassenger()},methods:{addStatistics(){const t=this.time;this.statistics[0].value=t,this.statistics[7].value=this.passengersCount-this.arrivalPassengerIndex;const e=this.serviceTimes.reduce(((t,e)=>t+e),0);this.statistics[3].value=e/(this.serviceTimes.length||1);const i=this.waitingTimes.filter((t=>t>p-c)),s=i.reduce(((t,e)=>t+e),0);this.statistics[6].value=s/(i.length||1),this.statistics[2].value=s/(this.waitingTimes.length||1),this.statistics[1].value=i.length/(this.waitingTimes.length||1),this.statistics[4].value=1-Math.min(e/(t*this.staticStationsCount||1),1);const a=this.statisticsGroup.selectAll("text").data(this.statistics);a.enter().append("text").attr("x",10).attr("y",((t,e)=>20*(e+1))).merge(a).text((t=>`${t.label}: ${t.value.toFixed(2)}`)),a.exit().remove()},generatePassengers(t,e,i){let s=0;for(let a=0;a<t;a++){s+=S(i);const t=this.passengersGroup.append("rect").attr("x",-this.passengerGraphicModelSize).attr("y",.5*(this.innerHeight-this.passengerGraphicModelSize)).attr("width",this.passengerGraphicModelSize).attr("height",this.passengerGraphicModelSize);e.push({number:a,arrivalTime:s,graphicObject:t})}return e},generateStations(t,e,i){const s=this.innerHeight/(i+1),a=2*this.passengerGraphicModelSize;for(let r=0;r<i;r++){t.append("rect").attr("x",this.innerWidth-a).attr("y",s*(1+r)-.25*this.passengerGraphicModelSize).attr("width",a+this.passengerGraphicModelSize).attr("height",.5*this.passengerGraphicModelSize).attr("fill",v[r%v.length]).classed("stationLine",!0);const i=t.append("rect").attr("x",this.innerWidth-a).attr("y",s*(1+r)-.5*this.passengerGraphicModelSize).attr("width",.3*this.passengerGraphicModelSize).attr("height",this.passengerGraphicModelSize).attr("fill",v[r%v.length]).classed("stationLine",!0),n=t.append("rect").attr("x",this.innerWidth).attr("y",s*(1+r)-.5*this.passengerGraphicModelSize).attr("width",this.passengerGraphicModelSize).attr("height",this.passengerGraphicModelSize).classed("train",!0);e.push({number:r,platform:i,train:n,passengersQueue:[]})}},arrivePassenger(){if(this.arrivalPassengerIndex>=this.passengers.length)return;const t=this.passengers[this.arrivalPassengerIndex],e=(t.arrivalTime-this.lastArrivalTime-p)*d;this.lastArrivalTime=t.arrivalTime,setTimeout((()=>t.graphicObject.transition().duration(d).attr("x",this.getPositionInGeneralQueue(this.generalPassengersQueue.length)).on("end",(()=>{this.time=t.arrivalTime,this.generalPassengersQueue.push(this.passengers[this.arrivalPassengerIndex]),this.arrivalPassengerIndex++,t.graphicObject.transition().duration(.5*d).attr("x",this.getPositionInGeneralQueue(this.generalPassengersQueue.length-1)),this.onArrivedPassenger()}))),e)},getPositionWithGeneralQueue(t){return.5*this.innerWidth+1.5*(1-t)*this.passengerGraphicModelSize},getPositionWithoutGeneralQueue(){return 1.5*this.passengerGraphicModelSize},getPositionInStationQueue(t,e){return t.platform.attr("x")-this.passengerGraphicModelSize-1.5*this.passengerGraphicModelSize*e},onArrivedPassenger(){this.trySelectStation(),this.arrivePassenger()},trySelectStation(){if(this.arrivalPassengerIndex>=this.passengers.length){const t=this.stations.filter((t=>t.passengersQueue.length>0));0===t.length&&clearInterval(this.statisticsTimerId)}if(0===this.generalPassengersQueue.length)return;const t=this.getFreeStation();if(void 0===t)return;const e=this.generalPassengersQueue.shift();this.orderGeneralQueue(),t.passengersQueue.push(e),e.graphicObject.attr("fill",t.platform.attr("fill")).transition().duration(.5*d).attr("x",this.getPositionInStationQueue(t,t.passengersQueue.length-1)).attr("y",t.platform.attr("y")).on("end",(()=>{e.graphicObject.transition().duration(.25*d).attr("x",this.getPositionInStationQueue(t,t.passengersQueue.indexOf(e)))})),1===t.passengersQueue.length&&this.takePassenger(e,t),this.trySelectStation()},getFreeStationWithGeneralQueue(){let t;const e=this.stations.filter((t=>0===t.passengersQueue.length));return e.length>0&&(t=e[Math.floor(Math.random()*e.length)]),t},getFreeStationWithoutGeneralQueue(){const t=this.stations.reduce(((t,e)=>Math.min(t,e.passengersQueue.length)),this.stations[0].passengersQueue.length),e=this.stations.filter((e=>e.passengersQueue.length===t));return e[Math.floor(Math.random()*e.length)]},orderGeneralQueue(){this.generalPassengersQueue.forEach(((t,e)=>t.graphicObject.transition().duration(.5*d).attr("x",this.getPositionInGeneralQueue(e))))},orderStationQueue(t){t.passengersQueue.forEach(((e,i)=>e.graphicObject.transition().duration(.5*d).attr("x",this.getPositionInStationQueue(t,i)).attr("y",t.platform.attr("y"))))},takePassenger(t,e){this.waitingTimes.push(this.time-t.arrivalTime);const i=S(this.takeInterval);this.serviceTimes.push(i);const s=i*d*.5;e.train.transition().duration(s).attr("x",e.platform.attr("x")-this.passengerGraphicModelSize).on("end",(()=>{t.graphicObject.transition().duration(s).attr("x",this.innerWidth),e.train.transition().duration(s).attr("x",this.innerWidth).on("end",(()=>{e.passengersQueue.shift(),e.passengersQueue.length>0?(this.orderStationQueue(e),this.takePassenger(e.passengersQueue[0],e)):this.trySelectStation()}))}))}}};function f(t,e,i,s){return u.Ys(t).append("svg").attr("width",e).attr("height",i).append("g").attr("transform",`translate(${s.left}, ${s.top})`)}function S(t){return p+Math.floor(Math.random()*t)}var w=i(7617);const b=(0,w.Z)(m,[["render",h]]);var Q=b,G={name:"App",components:{QueueChart:Q},data(){return{width:window.innerWidth,height:window.innerHeight,margin:{top:0,right:0,bottom:0,left:0},staticStationsCount:4,passengersCount:200,arrivalInterval:2,takeInterval:16}}},I=i(6319),P=i(9501),y=i(1410),x=i.n(y);const W=(0,w.Z)(G,[["render",n]]);var M=W;x()(G,"components",{QCard:I.Z,QCardSection:P.Z});var C=i(8286),T={config:{},plugins:{}};(0,s.ri)(M).use(C.Z,T).mount("#app")}},e={};function i(s){var a=e[s];if(void 0!==a)return a.exports;var r=e[s]={exports:{}};return t[s](r,r.exports,i),r.exports}i.m=t,function(){var t=[];i.O=function(e,s,a,r){if(!s){var n=1/0;for(l=0;l<t.length;l++){s=t[l][0],a=t[l][1],r=t[l][2];for(var o=!0,h=0;h<s.length;h++)(!1&r||n>=r)&&Object.keys(i.O).every((function(t){return i.O[t](s[h])}))?s.splice(h--,1):(o=!1,r<n&&(n=r));if(o){t.splice(l--,1);var u=a();void 0!==u&&(e=u)}}return e}r=r||0;for(var l=t.length;l>0&&t[l-1][2]>r;l--)t[l]=t[l-1];t[l]=[s,a,r]}}(),function(){i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,{a:e}),e}}(),function(){i.d=function(t,e){for(var s in e)i.o(e,s)&&!i.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})}}(),function(){i.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={143:0};i.O.j=function(e){return 0===t[e]};var e=function(e,s){var a,r,n=s[0],o=s[1],h=s[2],u=0;if(n.some((function(e){return 0!==t[e]}))){for(a in o)i.o(o,a)&&(i.m[a]=o[a]);if(h)var l=h(i)}for(e&&e(s);u<n.length;u++)r=n[u],i.o(t,r)&&t[r]&&t[r][0](),t[r]=0;return i.O(l)},s=self["webpackChunkqueue_visualization"]=self["webpackChunkqueue_visualization"]||[];s.forEach(e.bind(null,0)),s.push=e.bind(null,s.push.bind(s))}();var s=i.O(void 0,[998],(function(){return i(1029)}));s=i.O(s)})();
//# sourceMappingURL=app.b487893a.js.map